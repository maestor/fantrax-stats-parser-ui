<div class="stats-table-wrapper mat-elevation-z4">
  @if (loading) {
  <div class="loading">
    <mat-spinner></mat-spinner>
  </div>
  }

  <div class="search-container">
    <mat-form-field subscriptSizing="dynamic">
      <mat-label>{{ "table.playerSearch" | translate }}</mat-label>
      <input matInput (keyup)="filterItems($event)" #search />
    </mat-form-field>
  </div>

  <div class="table-container">
    <table mat-table [dataSource]="dataSource" matSort matSortStart="desc">
      <!-- Auto increment position column -->
      <ng-container matColumnDef="position">
        <th mat-header-cell *matHeaderCellDef>
          <span matTooltip="{{ 'tableColumn.position' | translate }}">
            {{ "tableColumnShort.position" | translate }}
          </span>
        </th>
        <td mat-cell *matCellDef="let element; let i = index">
          {{ i + 1 }}
        </td>
      </ng-container>

      <!-- Dynamic column renderer based on data -->
      @for (column of dynamicColumns; track column) {
      <ng-container [matColumnDef]="column">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>
          <span matTooltip="{{ 'tableColumn.' + column | translate }}">
            {{ "tableColumnShort." + column | translate }}
          </span>
        </th>
        <td mat-cell *matCellDef="let element">
          {{ element[column] !== "" ? element[column] : "-" }}
        </td>
      </ng-container>
      }

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr
        mat-row
        (click)="selectItem(row)"
        *matRowDef="let row; columns: displayedColumns"
      ></tr>
      <tr class="mat-row" *matNoDataRow>
        <td class="mat-cell no-results" [colSpan]="displayedColumns.length">
          <span>
              @if (loading) {
              @if (showWarmupMessage) {
                {{ "table.loadingWarmup" | translate }}
              } @else {
                {{ "table.loading" | translate }}
              }
              } @else {
                {{ "table.noSearchResults" | translate }}
              }
          </span>
        </td>
      </tr>
    </table>
  </div>
</div>
